<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wavefy Music</title>

<style>
:root{
  --blue:#38bdf8;
  --blue2:#0ea5e9;
  --bg:#020617;
  --card:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
}
*{box-sizing:border-box;font-family:system-ui,sans-serif}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
}

/* HEADER */
header{
  padding:16px;
  text-align:center;
  font-weight:800;
  font-size:22px;
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  color:#020617;
}

/* PLAYER */
.player{
  margin:16px;
  background:var(--card);
  border-radius:18px;
  padding:14px;
  box-shadow:0 20px 40px rgba(0,0,0,.5);
}
#frame{
  width:100%;
  aspect-ratio:16/9;
  border-radius:14px;
  border:none;
}
.song-title{font-weight:700;font-size:18px;margin-top:10px}
.song-artist{font-size:13px;color:var(--muted)}

/* CONTENT */
.content{padding-bottom:90px}
.section{margin:16px}
.track{
  padding:14px;
  border-radius:14px;
  background:#020617;
  margin-bottom:10px;
  cursor:pointer;
  transition:.2s;
}
.track:hover{transform:scale(1.02)}
.track small{color:var(--muted)}
.track.active{
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  color:#020617;
}

/* SEARCH */
.search-box{
  margin:16px;
}
.search-box input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
}

/* BOTTOM NAV */
.nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:64px;
  background:#020617ee;
  backdrop-filter:blur(8px);
  display:flex;
  justify-content:space-around;
  align-items:center;
  border-top:1px solid #0f172a;
}
.nav button{
  background:none;
  border:none;
  color:var(--muted);
  font-size:14px;
  cursor:pointer;
}
.nav button.active{
  color:var(--blue);
  font-weight:700;
}

/* ACTION SHEET */
.sheet{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:flex-end;
}
.sheet.active{display:flex}
.sheet-box{
  width:100%;
  background:#020617;
  border-radius:20px 20px 0 0;
  padding:16px;
  animation:slideUp .25s ease;
}
@keyframes slideUp{
  from{transform:translateY(100%)}
  to{transform:translateY(0)}
}
.sheet-box button{
  width:100%;
  padding:14px;
  margin-bottom:10px;
  border:none;
  border-radius:14px;
  background:#0f172a;
  color:var(--text);
  font-size:15px;
}
.sheet-box button.primary{
  background:linear-gradient(135deg,var(--blue),var(--blue2));
  color:#020617;
}
.sheet-box button.danger{
  background:#7f1d1d;
}
</style>
</head>
<body>

<header>üåä Wavefy Music</header>

<!-- PLAYER -->
<div class="player">
  <iframe id="frame" allow="autoplay"></iframe>
  <div class="song-title" id="title">Belum ada lagu</div>
  <div class="song-artist" id="artist">Pilih lagu dari Home / Playlist</div>
</div>

<!-- CONTENT -->
<div class="content">

  <!-- HOME -->
  <div id="home">
    <div class="section"><b>üî• Trending</b></div>
    <div class="section" id="homeList"></div>
  </div>

  <!-- SEARCH -->
  <div id="search" style="display:none">
    <div class="search-box">
      <input id="searchInput" placeholder="Cari lagu...">
    </div>
    <div class="section" id="searchList"></div>
  </div>

  <!-- PLAYLIST -->
  <div id="playlist" style="display:none">
    <div class="section"><b>üéß Playlist Kamu</b></div>
    <div class="section" id="playlistList"></div>
  </div>

</div>

<!-- BOTTOM NAV -->
<div class="nav">
  <button id="navHome" class="active" onclick="switchTab('home')">üè† Home</button>
  <button id="navSearch" onclick="switchTab('search')">üîç Search</button>
  <button id="navPlaylist" onclick="switchTab('playlist')">üìÇ Playlist</button>
</div>

<!-- ACTION SHEET -->
<div class="sheet" id="sheet">
  <div class="sheet-box" id="sheetBox"></div>
</div>

<script>
// ===== DATA =====
const defaultSongs = [
  {title:"Killer Queen", artist:"Queen", url:"https://soundcloud.com/queen-official/killer-queen"},
  {title:"Monster", artist:"Skillet", url:"https://soundcloud.com/skilletofficial/monster"},
  {title:"Believer", artist:"Imagine Dragons", url:"https://soundcloud.com/imaginedragons/believer"},
  {title:"Numb", artist:"Linkin Park", url:"https://soundcloud.com/linkinpark/numb"}
];

let userPlaylist = JSON.parse(localStorage.getItem("wavefy_playlist")||"[]");
let current = null;

// ===== UTIL =====
async function getEmbed(url){
  const r = await fetch(`https://soundcloud.com/oembed?format=json&url=${encodeURIComponent(url)}`);
  const d = await r.json();
  return {
    embed:d.html.match(/src="([^"]+)"/)[1],
    title:d.title,
    artist:d.author_name
  };
}
function savePlaylist(){
  localStorage.setItem("wavefy_playlist", JSON.stringify(userPlaylist));
}

// ===== PLAYER =====
async function playSong(song){
  const d = await getEmbed(song.url);
  frame.src = d.embed;
  title.textContent = d.title;
  artist.textContent = d.artist;
}

// ===== RENDER =====
function renderHome(){
  homeList.innerHTML="";
  defaultSongs.forEach(s=>{
    homeList.appendChild(trackItem(s,"home"));
  });
}
function renderSearch(){
  const q = searchInput.value.toLowerCase();
  searchList.innerHTML="";
  defaultSongs.filter(s=>s.title.toLowerCase().includes(q)||s.artist.toLowerCase().includes(q))
    .forEach(s=>searchList.appendChild(trackItem(s,"home")));
}
function renderPlaylist(){
  playlistList.innerHTML="";
  if(userPlaylist.length===0){
    playlistList.innerHTML="<small style='color:#94a3b8'>Playlist kosong</small>";
    return;
  }
  userPlaylist.forEach(s=>{
    playlistList.appendChild(trackItem(s,"playlist"));
  });
}

function trackItem(song, type){
  const d=document.createElement("div");
  d.className="track";
  d.innerHTML=`<b>${song.title}</b><br><small>${song.artist}</small>`;
  d.onclick=()=>playSong(song);

  let timer;
  d.addEventListener("pointerdown",()=>{
    timer=setTimeout(()=>openSheet(song,type),600);
  });
  d.addEventListener("pointerup",()=>clearTimeout(timer));
  d.addEventListener("pointerleave",()=>clearTimeout(timer));
  return d;
}

// ===== ACTION SHEET =====
function openSheet(song,type){
  sheetBox.innerHTML="";
  if(type==="home"){
    sheetBox.innerHTML=`
      <button class="primary">‚ûï Tambah ke Playlist</button>
      <button onclick="closeSheet()">‚ùå Batal</button>`;
    sheetBox.querySelector(".primary").onclick=()=>{
      if(!userPlaylist.find(s=>s.url===song.url)){
        userPlaylist.push(song);
        savePlaylist();
      }
      closeSheet();
    };
  }else{
    sheetBox.innerHTML=`
      <button class="danger">üóë Hapus dari Playlist</button>
      <button onclick="closeSheet()">‚ùå Batal</button>`;
    sheetBox.querySelector(".danger").onclick=()=>{
      userPlaylist=userPlaylist.filter(s=>s.url!==song.url);
      savePlaylist();
      renderPlaylist();
      closeSheet();
    };
  }
  sheet.classList.add("active");
}
function closeSheet(){sheet.classList.remove("active")}

// ===== NAV =====
function switchTab(tab){
  home.style.display=tab==="home"?"block":"none";
  search.style.display=tab==="search"?"block":"none";
  playlist.style.display=tab==="playlist"?"block":"none";

  navHome.classList.toggle("active",tab==="home");
  navSearch.classList.toggle("active",tab==="search");
  navPlaylist.classList.toggle("active",tab==="playlist");

  if(tab==="playlist") renderPlaylist();
}

// ===== EVENTS =====
searchInput.oninput=renderSearch;

// ===== INIT =====
renderHome();
renderSearch();
</script>

</body>
        </html>
